<%# Ê§úÁ¥¢ÁµêÊûú„ÅÆË°®Á§∫ %>
<% if @has_search_query %>
  <div style="padding: 15px 20px; background-color: #f5f5f5; margin: 20px auto; max-width: 1200px; border-radius: 8px;">
    <p style="margin: 0; font-size: 14px;">
      „Äå<strong><%= params.dig(:q, :title_or_description_cont) %></strong>„Äç„ÅÆÊ§úÁ¥¢ÁµêÊûú: 
      <strong><%= @works.count %></strong>‰ª∂
    </p>
    <%= link_to "Ê§úÁ¥¢„Çí„ÇØ„É™„Ç¢", works_path, 
        style: "color: #666; text-decoration: underline; margin-left: 15px; font-size: 13px;" %>
  </div>
<% end %>

<h1 style="text-align: center; margin: 20px 0;">‰ΩúÂìÅ‰∏ÄË¶ß</h1>

<!-- ‰ΩúÂìÅ„Ç∞„É™„ÉÉ„Éâ -->
<div class="works-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; max-width: 1200px; margin: 0 auto;">
  <% if @works.any? %>
    <% @works.each do |work| %>
      <div class="work-card" style="background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden; display: flex; flex-direction: column;">
        
        <!-- ‰ΩúÂìÅÁîªÂÉè -->
        <div class="work-image" style="width: 100%; aspect-ratio: 4/3; background: #f5f5f5; display: flex; align-items: center; justify-content: center;">
          <% if work.images.attached? %>
            <%= link_to work_path(work) do %>
              <%= image_tag work.images.first.variant(resize_to_limit: [400, 300]), style: "width: 100%; height: 100%; object-fit: cover;" %>
            <% end %>
          <% else %>
            <div style="color: #aaa; font-size: 40px;">üì∑</div>
          <% end %>
        </div>

        <!-- Êú¨Êñá -->
        <div style="padding: 15px; flex: 1;">
          <h3 style="font-size: 16px; font-weight: bold; margin-bottom: 8px;">
            <%= link_to work.title, work_path(work), style: "text-decoration: none; color: #333;" %>
          </h3>
          <p style="font-size: 13px; color: #666; margin-bottom: 10px;">
            <%= truncate(work.description, length: 60) %>
          </p>

          <!-- „É¶„Éº„Ç∂„ÉºÊÉÖÂ†± -->
          <div style="display: flex; align-items: center; gap: 8px;">
            <div style="width: 32px; height: 32px; border-radius: 50%; background: #ddd; overflow: hidden;">
              <% if work.user&.avatar&.attached? %>
                <%= image_tag work.user.avatar.variant(resize_to_limit: [32, 32]), style: "width: 100%; height: 100%; object-fit: cover;" %>
              <% end %>
            </div>
            <span style="font-size: 13px; color: #333;"><%= work.user&.display_name || "„É¶„Éº„Ç∂„Éº„Éç„Éº„É†" %></span>
          </div>
        </div>
      </div>
    <% end %>
  <% else %>
    <p style="text-align: center; color: #666; padding: 40px;">
      <%= @has_search_query ? "Ê§úÁ¥¢ÁµêÊûú„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü" : "‰ΩúÂìÅ„Åå„Åæ„Å†ÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì" %>
    </p>
  <% end %>
</div>